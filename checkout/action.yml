name: 'Storage Branch Checkout'
description: 'Checkout files from a storage branch'
author: 'taqm'

inputs:
  branch:
    description: 'Name of the storage branch to checkout from'
    required: true
    default: 'storage'
  files:
    description: |
      File mappings (one per line): <source> <destination>
      Use quotes for paths with spaces: "path with space/file.txt" dest.txt
    required: true
  working-directory:
    description: 'Working directory for destination paths'
    required: false
    default: '.'
  fail-on-missing:
    description: 'Fail if source file does not exist in the storage branch'
    required: false
    default: 'false'

runs:
  using: 'composite'
  steps:
    - name: Checkout storage branch files
      shell: bash
      env:
        INPUT_BRANCH: ${{ inputs.branch }}
        INPUT_FILES: ${{ inputs.files }}
        INPUT_WORKING_DIR: ${{ inputs.working-directory }}
        INPUT_FAIL_ON_MISSING: ${{ inputs.fail-on-missing }}
        SCRIPT_DIR: ${{ github.action_path }}/../scripts
      run: bash "${{ github.action_path }}/checkout.sh"
